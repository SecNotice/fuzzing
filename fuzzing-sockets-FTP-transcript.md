В этом посте я поделюсь результатами первой части моего исследования фаззинга. В качестве практического примера я расскажу о своем фаззинг-анализе трех широко используемых FTP-серверов и подробно опишу уязвимости, найденные в результате этих усилий.

Выбор протокола FTP основан на следующих причинах:

* FTP является одним из наиболее широко используемых сетевых протоколов и имеет долгую историю;
* используются параллельные каналы связи (как командные, так и информационные);
* это интерактивный файловый сервер, позволяющий вносить изменения в файлы на стороне сервера;
* это простой текстовый протокол, который в принципе не оптимален для фаззинга (и мне нравятся проблемы!).
Я также приведу несколько советов о том, как справляться с любыми изменениями исходного кода, чтобы иметь возможность фаззить программное обеспечение, использующее сокеты, с использованием AFL++.

Выбранные серверы и результаты
Для начала я использовал API-интерфейс SHODAN для выбора наиболее подходящих FTP-серверов из вариантов доступных FTP-серверов с открытым исходным кодом. Я выбрал FTP-серверы, которые имели наибольшее количество публично выставленных экземпляров:

Pure-FTPd: самый популярный Linux ftpd
BFtpd: очень популярный ftpd для встраиваемых систем
ProFtpd: самый старый из трех, но все еще популярный Linux ftpd
В результате этих усилий я сообщил о следующих ошибках:
